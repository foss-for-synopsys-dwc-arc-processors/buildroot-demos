From fed4b164b5bf07c8e254a4e32cbc0f01b441223b Mon Sep 17 00:00:00 2001
From: Eugeniy Paltsev <Eugeniy.Paltsev@synopsys.com>
Date: Mon, 27 Jan 2020 20:04:29 +0300
Subject: [PATCH 19/23] HDMI: fix PHY settings for high pixelclock

Signed-off-by: Eugeniy Paltsev <Eugeniy.Paltsev@synopsys.com>
---
 drivers/gpu/drm/dw_hdmi.c | 64 +++++++++++++++--------------------------------
 1 file changed, 20 insertions(+), 44 deletions(-)

diff --git a/drivers/gpu/drm/dw_hdmi.c b/drivers/gpu/drm/dw_hdmi.c
index 0d83eb7e5f85..3ca7a1ac8b1e 100644
--- a/drivers/gpu/drm/dw_hdmi.c
+++ b/drivers/gpu/drm/dw_hdmi.c
@@ -15,40 +15,24 @@
 
 static const struct dw_hdmi_mpll_config snps_mpll_cfg[] = {
 	{
-		26740000, {
-			{ 0x00B3, 0x0000 },
-			{ 0x00B3, 0x0000 },
-			{ 0x00B3, 0x0000 }
-		},
-	}, {
 		27000000, {
 			{ 0x00B3, 0x0000 },
 			{ 0x00B3, 0x0000 },
 			{ 0x00B3, 0x0000 }
 		},
 	}, {
-		45250000, {
-			{ 0x01e0, 0x0000 },
-			{ 0x21e1, 0x0000 },
-			{ 0x41e2, 0x0000 }
-		},
-	}, {
-		92500000, {
-			{ 0x0140, 0x0005 },
-			{ 0x2141, 0x0005 },
-			{ 0x4142, 0x0005 },
+		/* Paul one ::no 8 HDMI 1.4 */
+		74250000, {
+			{ 0x0072, 0x0001},
+			{ 0x0072, 0x0001},
+			{ 0x0072, 0x0001}
 		},
 	}, {
+		/* Paul one ::no 8 HDMI 1.4 */
 		148500000, {
-			{ 0x00a0, 0x000a },
-			{ 0x20a1, 0x000a },
-			{ 0x40a2, 0x000a },
-		},
-	}, {
-		216000000, {
-			{ 0x00a0, 0x000a },
-			{ 0x2001, 0x000f },
-			{ 0x4002, 0x000f },
+			{ 0x0051, 0x0002},
+			{ 0x0051, 0x0002},
+			{ 0x0051, 0x0002}
 		},
 	}, {
 		~0UL, {
@@ -62,32 +46,24 @@ static const struct dw_hdmi_mpll_config snps_mpll_cfg[] = {
 static const struct dw_hdmi_curr_ctrl snps_cur_ctr[] = {
 	/*      pixelclk     bpp8    bpp10   bpp12 */
 	{
-		26740000, { 0x0000, 0x0000, 0x0000 },
-	}, {
-		27000000, { 0x0000, 0x0000, 0x0000 },
-	}, {
-		54000000, { 0x091c, 0x091c, 0x06dc },
-	}, {
-		58400000, { 0x091c, 0x06dc, 0x06dc },
-	}, {
-		72000000, { 0x06dc, 0x06dc, 0x091c },
-	}, {
-		74250000, { 0x06dc, 0x0b5c, 0x091c },
+		27000000,  { 0x0000, 0x0000, 0x0000 },
 	}, {
-		118800000, { 0x091c, 0x091c, 0x06dc },
+		/* Paul one */
+		74250000,  { 0x0008, 0x0008, 0x0008 },
 	}, {
-		216000000, { 0x06dc, 0x0b5c, 0x091c },
+		/* Paul one */
+		148500000, { 0x001b, 0x001b, 0x001b },
 	}, {
-		~0UL, { 0x0000, 0x0000, 0x0000 },
+		~0UL,      { 0x0000, 0x0000, 0x0000 },
 	},
 };
 
 static const struct dw_hdmi_phy_config snps_phy_config[] = {
-	/*pixelclk   symbol   term   vlev */
-	{ 26740000,  0x8009, 0x0004, 0x0232},
-	{ 27000000,  0x8009, 0x0004, 0x0232},
-	{ 216000000, 0x800d, 0x0005, 0x01ad},
-	{ ~0UL,      0x8009, 0x0004, 0x0232}
+	/*pixelclk    symbol   term   vlev */
+	{ 27000000,   0x8009, 0x0004, 0x0232},
+	{ 74250000,   0x8009, 0x0004, 0x0232},
+	{ 148500000,  0x8009, 0x0004, 0x0232},
+	{ ~0UL,       0x8009, 0x0004, 0x0232}
 };
 
 /* FIXME: FPGA realization supports only 27MHz. */
-- 
2.16.2

