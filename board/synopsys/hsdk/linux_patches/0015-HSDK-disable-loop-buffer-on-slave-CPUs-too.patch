From 73641a525eaa93d84b900283a0ee1800d0896d19 Mon Sep 17 00:00:00 2001
From: Eugeniy Paltsev <Eugeniy.Paltsev@synopsys.com>
Date: Thu, 23 Jan 2020 16:28:42 +0300
Subject: [PATCH 15/23] HSDK: disable loop buffer on slave CPUs too

Signed-off-by: Eugeniy Paltsev <Eugeniy.Paltsev@synopsys.com>
---
 arch/arc/plat-hsdk/platform.c | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/arch/arc/plat-hsdk/platform.c b/arch/arc/plat-hsdk/platform.c
index 65879075d29b..e1c956b59e41 100644
--- a/arch/arc/plat-hsdk/platform.c
+++ b/arch/arc/plat-hsdk/platform.c
@@ -19,6 +19,9 @@ int arc_hsdk_axi_dmac_coherent __section(.data) = 0;
 
 static void __init hsdk_init_per_cpu(unsigned int cpu)
 {
+	if (read_aux_reg(ARC_REG_LPB_BUILD))
+		write_aux_reg(ARC_REG_LPB_CTRL, 1);
+
 	/*
 	 * By default ICCM is mapped to 0x7z while this area is used for
 	 * kernel virtual mappings, so move it to currently unused area.
-- 
2.16.2

